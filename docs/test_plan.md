# PPTç”Ÿæˆæµç¨‹æµ‹è¯•è®¡åˆ’ (ä¼˜åŒ–ç‰ˆ)

## ğŸ¯ æµ‹è¯•ç›®æ ‡

å»ºç«‹å®Œæ•´çš„PPTç”Ÿæˆæµç¨‹æµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿ä»ç”¨æˆ·è¾“å…¥åˆ°PPTå¯¼å‡ºçš„å„ä¸ªç¯èŠ‚è´¨é‡ç¨³å®šï¼Œæå‡ç³»ç»Ÿå¯é æ€§å’Œç”¨æˆ·ä½“éªŒã€‚åŸºäºä»£ç æ¶æ„åˆ†æï¼Œé‡ç‚¹è§£å†³æµå¼è§£æã€Server Actions ç¼ºä¹è¿è¡Œæ—¶éªŒè¯ã€å›¾ç‰‡å¹¶å‘é£æš´ã€PPTXå¯¼å‡ºä¸€è‡´æ€§ç­‰å…³é”®é£é™©ã€‚

## ğŸ“Š å½“å‰æµ‹è¯•çŠ¶æ€

- âŒ æµ‹è¯•è¦†ç›–ç‡: 0% (å½“å‰æ— ä»»ä½•æµ‹è¯•)
- âŒ æµ‹è¯•æ¡†æ¶: æœªé…ç½®
- âŒ CI/CD: ç¼ºå°‘è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹
- âš ï¸ æ¶æ„é£é™©: Server Actions æ— è¿è¡Œæ—¶éªŒè¯ï¼Œå›¾ç‰‡ç”ŸæˆN+1å¹¶å‘é—®é¢˜ï¼ŒXMLè§£æè„†å¼±æ€§

## ğŸ”„ ç­–ç•¥é‡æ„ä¸å…³é”®å˜æ›´

### æµ‹è¯•é‡‘å­—å¡”ä¸åˆ†å±‚è´£ä»»
- **å•å…ƒæµ‹è¯• > å¥‘çº¦æµ‹è¯• > é›†æˆæµ‹è¯• > E2Eæµ‹è¯•**ï¼ŒæŒ‰å®æ–½æˆæœ¬ä¸æ”¶ç›Šé€’å‡å®‰æ’æ—¶é—´ä¸è¦†ç›–
- é£é™©é©±åŠ¨ï¼šä¼˜å…ˆè¦†ç›–é«˜é£é™©æ¨¡å—ï¼ˆParserã€Server Actionsã€æµå¼ç”Ÿæˆã€å¹¶å‘å›¾ç‰‡ï¼‰

### æ¡†æ¶ä¸å·¥å…·å»ºè®®ï¼ˆæ ¸å¿ƒæ›¿æ¢ï¼‰

#### æµ‹è¯•æ¡†æ¶
- **å•å…ƒ/å¥‘çº¦**: Vitest + @testing-library/react + @testing-library/jest-dom
  - ç†ç”±ï¼šESM å…¼å®¹ã€é€Ÿåº¦ä¸ DX ä¼˜äº Jestï¼Œæ”¯æŒ Node/jsdom åŒç¯å¢ƒ
- **E2E**: Playwrightï¼ˆChromium/Firefox/WebKit å¤šé¡¹ç›®çŸ©é˜µï¼‰
- **Mock/æ¡©**: MSWï¼ˆNode + æµè§ˆå™¨åŒç«¯ï¼‰ï¼Œéš”ç¦» AI/å¤–éƒ¨ç½‘ç»œä¸ Upload æœåŠ¡
- **DBæµ‹è¯•**: PostgreSQL Testcontainersï¼ˆå¼ºçƒˆå»ºè®®æ›¿æ¢"SQLite å†…å­˜"ï¼‰
  - ç†ç”±ï¼šé¿å… JSONB/Array ä¸ç”Ÿäº§ç¯å¢ƒä¸ä¸€è‡´
- **PPTXéªŒè¯**: jszip + fast-xml-parserï¼ˆç›´æ¥æ ¡éªŒ .pptx å†…éƒ¨ OpenXML ç»“æ„ï¼‰
- **æ€§èƒ½/è´Ÿè½½**: Artillery æˆ– k6ï¼ˆCI å¤œé—´æ‰§è¡Œï¼‰
- **ç”Ÿæˆç¨³å®šæ€§**: fast-checkï¼ˆå±æ€§æµ‹è¯•ï¼‰è¦†ç›–è§£æå™¨å®¹é”™ä¸éå¸¸è§„ XML

#### å¥‘çº¦å…ˆè¡Œï¼ˆZod Schemaï¼‰
- **é—®é¢˜**: Server Actions ä¸¥é‡ä¾èµ– TypeScript é™æ€æ£€æŸ¥ï¼Œè¿è¡Œæ—¶ç›´æ¥æ–­è¨€ä¸º `InputJsonValue`
- **è§£å†³**: ä¸ºæ‰€æœ‰ Server Actions ä¸ API Routes è¡¥ä¸Šè¿è¡Œæ—¶ Schema
- **è´¨é‡é—¨æ§›**: æ—  Schema çš„ Action/Route ä¸å…è®¸åˆå¹¶

#### é£é™©é©±åŠ¨æµ‹è¯•é¢
1. **æµå¼ç”Ÿæˆ + è§£æç¨³å¥æ€§**
   - ä¸å®Œæ•´/ç•¸å½¢æ ‡ç­¾ã€è·¨å¸§æ–­è£‚ã€IMG query å¼•å·å®Œæ•´æ€§
2. **å›¾ç‰‡ç”Ÿæˆå¹¶å‘é£æš´**
   - é˜Ÿåˆ—/èŠ‚æµç­–ç•¥éªŒè¯ï¼Œé¿å…è¿æ¥æ± è€—å°½
3. **åƒµå°¸ç”Ÿæˆ/ä¸­æ–­æ¢å¤**
   - åˆ·æ–°/å…³é—­é¡µé¢ â†’ ä¸æ®‹ç•™æµæ°´ã€DB ä¸ç•™"Untitled"åƒåœ¾
4. **æ•°æ®ä¸€è‡´æ€§**
   - PlateSlide JSON å…¥åº“å‰éªŒè¯ï¼Œç¦æ­¢ `unknownâ†’InputJsonValue` ç›´å¡
5. **ä¸»é¢˜/ç‰ˆå¼å…¨è¦†ç›–**
   - 15+ å¸ƒå±€çš„æœ€å°è¯æ˜æ ·ä¾‹ + å¯¼å‡ºä¸€è‡´æ€§

## ğŸš€ é˜¶æ®µåŒ–å®æ–½ï¼ˆå«å¯é‡åŒ–é—¨æ§›ï¼‰

### é˜¶æ®µ0ï¼šå¿«é€Ÿå†’çƒŸä¸è„šæ‰‹æ¶ï¼ˆä¼˜å…ˆçº§ï¼šğŸ”´ æœ€é«˜ï¼Œ1-2å¤©ï¼‰

#### æ–°å¢è„šæœ¬ä¸ä¾èµ–
```json
{
  "scripts": {
    "test": "vitest",
    "test:unit": "vitest run src/**/*.test.ts",
    "test:integration": "vitest run tests/integration/**/*.test.ts",
    "test:e2e": "playwright test",
    "test:coverage": "vitest --coverage",
    "test:smoke": "vitest run tests/smoke/**/*.test.ts"
  },
  "devDependencies": {
    "vitest": "^1.0.0",
    "@testing-library/react": "^14.0.0", 
    "@testing-library/jest-dom": "^6.0.0",
    "playwright": "^1.40.0",
    "msw": "^2.0.0",
    "testcontainers": "^10.0.0",
    "jszip": "^3.10.0",
    "fast-xml-parser": "^4.3.0",
    "fast-check": "^3.15.0"
  }
}
```

#### å»ºç«‹é¦–æ‰¹å†’çƒŸç”¨ä¾‹
1. **Parser æœ€å°ç”¨ä¾‹**ï¼šH1/P/IMG/SECTION åŸºç¡€è§£æ
2. **API Routes**: `/outline`ã€`/generate` å¿…å¡«å­—æ®µ 400 å“åº”
3. **PPTX å¯¼å‡º**: 1 å¼ ç©ºç™½å¹»ç¯ç‰‡å¯æ‰“å¼€ï¼ˆzip ç»“æ„é½å…¨ï¼‰

#### CI è´¨é‡é—¨æ§›
- **æ‰€æœ‰ PR å¿…è¿‡**: lint + type + unit-smoke + e2e-smokeï¼ˆâ‰¤5minï¼‰
- **è¦†ç›–ç‡**: â‰¥20%ï¼ˆä¸´æ—¶å€¼ï¼Œä»…é™ `src/components/presentation/utils/parser.ts` + å…³é”® APIï¼‰

### é˜¶æ®µ1ï¼šæµ‹è¯•åŸºç¡€è®¾æ–½ï¼ˆ1å‘¨ï¼‰

#### æ¡†æ¶ä¸ç¯å¢ƒ
- **Vitest**: node + jsdom åŒç¯å¢ƒé…ç½®
- **Playwright**: é¡¹ç›®çŸ©é˜µï¼ˆchromiumã€firefoxã€webkitï¼‰
- **æµ‹è¯•æ•°æ®åº“**: Testcontainers å¯åŠ¨ Postgresï¼Œprisma migrate è‡³éš”ç¦» schema
- **MSW**: Node ç«¯ mock Together/Upload/Webæœç´¢ï¼›æµè§ˆå™¨ç«¯æ‹¦æˆªå¤–éƒ¨è°ƒç”¨

#### CI/CD ä¸‰è½¦é“
- **PR å¿«æµ‹**ï¼ˆ10åˆ†é’Ÿï¼‰ï¼šlint + type + smoke
- **Merge å®Œæ•´å¥—ä»¶**ï¼ˆ30åˆ†é’Ÿï¼‰ï¼šå…¨é‡å•å…ƒ + é›†æˆ + æ ¸å¿ƒE2E
- **å¤œé—´é•¿æµ‹**ï¼šå…¼å®¹æ€§ + æ€§èƒ½ + å¯è§†åŒ–å›å½’

#### ç¯å¢ƒå˜é‡/æ—¶é—´ä¸éšæœºæ€§
- **ç»Ÿä¸€å‡æ—¶é’Ÿ**ï¼šfakeTimers ç¡®ä¿æ—¶é—´ç›¸å…³æµ‹è¯•ç¨³å®š
- **ç»Ÿä¸€éšæœºç§å­**ï¼šfaker.seed ç¡®ä¿å¿«ç…§ç¨³å®š

### é˜¶æ®µ2ï¼šæ ¸å¿ƒå¥‘çº¦ä¸å•å…ƒï¼ˆä¼˜å…ˆçº§ï¼šğŸ”´ é«˜ï¼Œ2-3å‘¨ï¼‰

#### å¥‘çº¦ï¼ˆZodï¼‰åŠ æµ‹è¯•ï¼ˆå…³è”æ–‡ä»¶ï¼‰
1. **API Routes å¥‘çº¦åŒ–**
   - `/api/presentation/outline`ï¼ˆ`src/app/api/presentation/outline/route.ts`ï¼‰
   - `/api/presentation/outline-with-search`ï¼ˆå« tools è°ƒç”¨ï¼‰
   - `/api/presentation/generate`ï¼ˆ`SlidesRequest`ï¼štitle/outline/language/tone/searchResultsï¼‰

2. **Server Actions å¥‘çº¦åŒ–**
   - `createPresentation`/`updatePresentation`ï¼ˆ`src/app/_actions/presentation/presentationActions.ts`ï¼‰
   - å¯¹ PlateSlide[] åš JSON Schemaï¼ˆZodï¼‰éªŒè¯ï¼Œç¦æ­¢ `unknownâ†’InputJsonValue` ç»•è¿‡

#### è§£æå™¨ï¼ˆ`src/components/presentation/utils/parser.ts`ï¼‰
**è¦†ç›–è¦ç‚¹**ï¼š
- SECTION æå–ã€PRESENTATION åŒ…è£¹å‰¥ç¦»ã€DIV æå‡
- IMG å¼•å·å®Œæ•´æ€§ã€layout å±æ€§æ ¡éªŒ
- 15+ å¸ƒå±€æ˜ å°„ï¼ˆCOLUMNS/BULLETS/ICONS/CYCLE/ARROWSç­‰ï¼‰
- finalize() å°¾æ®µè¡¥é½ã€ç”Ÿæˆä¸­æ ‡è®°é€»è¾‘
- æµå¼è§£æçš„æ–­å¸§æ¢å¤èƒ½åŠ›

#### æ¨¡å‹é€‰æ‹©å™¨ï¼ˆ`src/lib/model-picker.ts`ï¼‰
**è¦†ç›–è¦ç‚¹**ï¼š
- Provider ä¸å¯ç”¨/é‡è¯•/å›é€€è·¯å¾„
- modelId å‰ç¼€çº¦æŸï¼ˆdeepseek-* vs openai modelsï¼‰
- ç¯å¢ƒå˜é‡ç¼ºå¤±æ—¶çš„é”™è¯¯å¤„ç†

#### å¯¼å‡ºå™¨ï¼ˆ`src/components/presentation/utils/exportToPPT.ts`ï¼‰
**è¦†ç›–è¦ç‚¹**ï¼š
- PlateSlide â†’ PPTX è½¬æ¢å‡†ç¡®æ€§
- ä¸»é¢˜è‰²åº”ç”¨ã€å¸ƒå±€å®šä½ã€å›¾ç‰‡åµŒå…¥
- OpenXML ç»“æ„å®Œæ•´æ€§ï¼ˆContent_Typesã€relsã€slidesï¼‰

### é˜¶æ®µ3ï¼šé›†æˆï¼ˆç»„ä»¶ + çŠ¶æ€ + åç«¯è¾¹ç•Œï¼‰ï¼ˆä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­é«˜ï¼Œ1å‘¨ï¼‰

#### ç”Ÿæˆç®¡ç†å™¨ï¼ˆ`PresentationGenerationManager.tsx`ï¼‰
**æµ‹è¯•ç„¦ç‚¹**ï¼š
- æµå¼è§£æä¸ RAF åˆå¹¶æ›´æ–°æœºåˆ¶
- æ ‡é¢˜æŠ½å–ï¼ˆ`<TITLE>...</TITLE>`ï¼‰ä¸çŠ¶æ€åŒæ­¥
- webSearch ç¼“å†²ä¸ searchResults çŠ¶æ€ç®¡ç†
- rootImageGeneration çš„ pending/success/error çŠ¶æ€æµè½¬
- ç¼©ç•¥å›¾ä¸€æ¬¡æ€§æŒä¹…åŒ–é€»è¾‘
- å¹¶å‘å›¾ç‰‡ç”Ÿæˆçš„é˜Ÿåˆ—åŒ–å¤„ç†

#### Zustand Storeï¼ˆ`src/states/presentation-state.ts`ï¼‰
**æµ‹è¯•ç„¦ç‚¹**ï¼š
- çŠ¶æ€åŠ¨ä½œæ­£ç¡®æ€§ï¼ˆstart/reset/merge æ“ä½œï¼‰
- è¾¹ç•Œæ¡ä»¶ï¼šå¹¶å‘ rootImage è¯·æ±‚ã€æ¸…ç©º/æ¢å¤æ—¶ä¸ä¸¢ presentationId
- çŠ¶æ€æŒä¹…åŒ–ä¸æ¢å¤ï¼ˆé¡µé¢åˆ·æ–°åœºæ™¯ï¼‰

#### å›¾ç‰‡ç”ŸæˆåŠ¨ä½œï¼ˆ`_actions/image/generate.ts`ï¼‰
**æµ‹è¯•ç„¦ç‚¹**ï¼š
- Together AI â†’ UploadThing å®Œæ•´é“¾è·¯
- å¤±è´¥è·¯å¾„ï¼šTogether å¤±è´¥ã€ä¸‹è½½å¤±è´¥ã€Upload å¤±è´¥
- DB æŒä¹…åŒ–æˆåŠŸä¸ URL è¿”å›
- å¹¶å‘è°ƒç”¨çš„é€Ÿç‡é™åˆ¶éªŒè¯

### é˜¶æ®µ4ï¼šç«¯åˆ°ç«¯ï¼ˆä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ï¼Œ1å‘¨ï¼‰

#### ç”¨æˆ·ä¸»è·¯å¾„
1. **å®Œæ•´æµç¨‹æµ‹è¯•**
   - ç™»å½• â†’ åˆ›å»ºç©ºæ–‡æ¡£ â†’ å¤§çº²ç”Ÿæˆï¼ˆå¸¦/ä¸å¸¦æœç´¢ï¼‰ â†’ ç”Ÿæˆæ¼”ç¤º â†’ ç¼–è¾‘ â†’ å¯¼å‡ºPPTX
   - å¤šç§å¸ƒå±€ç±»å‹çš„å®Œæ•´æµç¨‹éªŒè¯
   - AI ç”Ÿæˆå¤±è´¥æ—¶çš„é™çº§æµ‹è¯•
   - å¤§å‹æ¼”ç¤ºæ–‡ç¨¿æ€§èƒ½æµ‹è¯•ï¼ˆ20+å¼ å¹»ç¯ç‰‡ï¼‰

2. **å¼‚å¸¸ä¸æ¢å¤åœºæ™¯**
   - æ­£åœ¨ç”Ÿæˆæ—¶åˆ·æ–°é¡µé¢ï¼ˆçŠ¶æ€æ¢å¤æµ‹è¯•ï¼‰
   - å…³é—­æ ‡ç­¾é¡µåä¸ç»§ç»­æ¶ˆè€— AI Token
   - AI æœåŠ¡å¤±è´¥é™çº§åˆ° modelPickerWithRetry
   - ç½‘ç»œæ–­å¼€é‡è¿æœºåˆ¶

3. **æ•°æ®ä¸€è‡´æ€§éªŒè¯**
   - ç”Ÿæˆè¿‡ç¨‹ä¸­ä¸­æ–­ï¼ŒDB ä¸åº”æ®‹ç•™â€œUntitledâ€ç©ºæ–‡æ¡£
   - æµå¼è§£æä¸­æ–­ä¸åº”å¯¼è‡´çŠ¶æ€é”™ä¹±

#### æµè§ˆå™¨çŸ©é˜µä¸å“åº”å¼
- **è·¨æµè§ˆå™¨å…¼å®¹æ€§**ï¼šChromium/Firefox/WebKit
- **è§†å£å“åº”å¼**ï¼šçª„/å®½è§†å£ä¸‹çš„ç•Œé¢ä¸äº¤äº’
- **ä¸»é¢˜åˆ‡æ¢**ï¼šæ˜æš—æ¨¡å¼åˆ‡æ¢ä¸å½±å“åŠŸèƒ½

### é˜¶æ®µ5ï¼šPPTX å¯¼å‡ºéªŒè¯ï¼ˆä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ï¼Œ1å‘¨ï¼‰

#### å‡†ç¡®æ€§éªŒè¯
**ä½¿ç”¨ jszip æ‰“å¼€ ArrayBufferï¼Œæ ¡éªŒï¼š**
1. **ç»“æ„å®Œæ•´æ€§**
   - slide æ•°é‡ä¸é¡ºåºï¼Œè‡³å°‘ä¸€ä¸ª `p:sld`
   - å›¾ç‰‡ä»¥ `p:pic` é“¾å…¥å¹¶æ­£ç¡®å¼•ç”¨ media æ–‡ä»¶
   - å¸ƒå±€å˜ä½“æ˜ å°„ï¼ˆleft/right/verticalï¼‰å¯¹åº”å›¾ç‰‡ä¸å†…å®¹å ä½åŒºåŸŸæ¯”ä¾‹

2. **æ–‡æœ¬æ ·å¼ä¸€è‡´æ€§**
   - æ–‡å­— runsï¼ˆ`a:r`ï¼‰æ•°ä¸æ ·å¼ï¼ˆé¢œè‰²/åŠ ç²—ï¼‰ä¸ Plate æ ‡è®°ä¸€è‡´
   - å­—ä½“å®¶æ—ã€å­—å·çš„æ­£ç¡®æ˜ å°„

3. **å¿…è¦æ–‡ä»¶å­˜åœ¨**
   - `[Content_Types].xml`ã€`_rels/.rels`ã€`ppt/presentation.xml`
   - `ppt/slides/_rels/slideX.xml.rels` å¯¹åº”å…³ç³»
   - `ppt/media/` ä¸‹çš„å›¾ç‰‡æ–‡ä»¶

#### å®Œæ•´æ€§ä¸å¯æ‰“å¼€æ€§
- **åŸºç¡€å¯ç”¨æ€§**ï¼šç”Ÿæˆçš„ PPTX æ–‡ä»¶å¯åœ¨ PowerPoint/LibreOffice ä¸­æ­£å¸¸æ‰“å¼€
- **å¿«é€Ÿæ‰“å¼€æ€§ smoke**ï¼ˆå¯é€‰ç”¨ headless LibreOffice è½¬ PDF äºå¤œé—´æµæ°´çº¿ï¼‰

#### ä¸»é¢˜ä¸€è‡´æ€§
- **ä¸»é¢˜è‰²ä¸æ˜æš—å¯¹æ¯”**
  - æŠ½æ ·æ ¡éªŒ `converter.isLightColor` çš„é˜ˆå€¼è¡Œä¸º
  - èƒŒæ™¯/æ–‡å­—è‰²æ­é…ç¬¦åˆå¯è¯»æ€§æ ‡å‡†
- **å¸ƒå±€ä¸»é¢˜ä¸€è‡´æ€§**
  - åŒä¸€ä¸»é¢˜ä¸‹ä¸åŒå¸ƒå±€ç±»å‹çš„è§†è§‰ç»Ÿä¸€æ€§

### é˜¶æ®µ6ï¼šæ€§èƒ½ä¸å¯é æ€§ï¼ˆä¼˜å…ˆçº§ï¼šğŸŸ¡ ä¸­ï¼Œ1å‘¨ï¼‰

#### API Budget ä¸å“åº”æ—¶é—´
- **API åŸºå‡†**
  - `/outline`ã€`/generate` P95 < 3sï¼ˆä¸å« AI å»¶è¿Ÿæ—¶ï¼šæœ¬åœ° stubï¼‰
  - å¯¼å‡º < 10sï¼ˆ20 å¼ å¹»ç¯ç‰‡å†…ï¼‰
  - Server Actions å“åº”æ—¶é—´ < 1s

#### å¹¶å‘åœºæ™¯æµ‹è¯•
- **è´Ÿè½½æµ‹è¯•**
  - 10/50/100 å¹¶å‘ç”Ÿæˆï¼ˆstub AIï¼‰ï¼Œè¿æ¥æ± ä¸è€—å°½
  - å›¾ç‰‡ç”Ÿæˆé™æµç­–ç•¥æœ‰æ•ˆï¼ˆä¸äº§ç”Ÿé£æš´ï¼‰
  - DB è¿æ¥æ± ä¸äº‹åŠ¡ç®¡ç†åœ¨é«˜å¹¶å‘ä¸‹çš„è¡¨ç°

#### å¤±è´¥æ³¨å…¥ä¸å®¹é”™
- **ç½‘ç»œä¸æœåŠ¡å¤±è´¥**
  - äººä¸ºè¶…æ—¶/ä¸­æ–­ã€ç½‘ç»œæŠ–åŠ¨æ¨¡æ‹Ÿ
  - AI æœåŠ¡ 429/5xx å›é€€åˆ° `modelPickerWithRetry`
  - UploadThing ä¸Šä¼ å¤±è´¥çš„é™çº§å¤„ç†
- **èµ„æºè€—å°½**
  - DB è¿æ¥æ± è€—å°½ã€å†…å­˜æº¢å‡ºæ¨¡æ‹Ÿ
  - AI Token é™é¢è¾¾åˆ°ä¸Šé™çš„å¤„ç†

### é˜¶æ®µ7ï¼šå…¼å®¹ä¸PWAï¼ˆä¼˜å…ˆçº§ï¼šğŸŸ¢ ä½ï¼Œå¯é™çº§ä¸ºå¤œé—´ï¼‰

#### PWA åŠŸèƒ½éªŒè¯ï¼ˆè‹¥å¯ç”¨ï¼‰
- **Service Worker æ³¨å†Œ**ä¸ç”Ÿå‘½å‘¨æœŸ
- **ç¦»çº¿å…œåº•é¡µ**å’Œç¼“å­˜ç­–ç•¥å…³é”®è·¯å¾„éªŒè¯
- **åº”ç”¨å®‰è£…**ä¸æ›´æ–°æç¤º

#### è¾…åŠ©åŠŸèƒ½ä¸å¯è®¿é—®æ€§
- **é”®ç›˜å¯¼èˆª**ä¸å±å¹•é˜…è¯»å™¨å…¼å®¹æ€§
- **è‰²ç›²å‹å¥½**ä¸é«˜å¯¹æ¯”åº¦æ¨¡å¼

## ğŸ“ è¦†ç›–æ¸…å•æ˜ å°„åˆ°çœŸå®ä»£ç 

### æ ¸å¿ƒæ¨¡å—è·¯å¾„
- **API Routes**
  - `src/app/api/presentation/outline/route.ts`
  - `src/app/api/presentation/outline-with-search/route.ts`
  - `src/app/api/presentation/generate/route.ts`

- **è§£æä¸å¯¼å‡º**
  - `src/components/presentation/utils/parser.ts` (SlideParser ç±»)
  - `src/components/presentation/utils/exportToPPT.ts` (PlateJSToPPTXConverter)

- **Server Actions**
  - `src/app/_actions/presentation/presentationActions.ts`
  - `src/app/_actions/image/generate.ts`

- **çŠ¶æ€ç®¡ç†**
  - `src/components/presentation/dashboard/PresentationGenerationManager.tsx`
  - `src/states/presentation-state.ts` (Zustand Store)

- **æ¨¡å‹ä¸å·¥å…·**
  - `src/lib/model-picker.ts` (å¤šæä¾›å•†é€‰æ‹©å™¨)

### é«˜é£é™©åŒºåŸŸé‡ç‚¹è¦†ç›–
1. **æµå¼è§£æç¨³å¥æ€§** (`parser.ts` çš„ `parseChunk`/`finalize`)
2. **å¹¶å‘å›¾ç‰‡é£æš´** (`PresentationGenerationManager.tsx` çš„ `updateSlidesWithRAF`)
3. **Server Actions æ•°æ®å®‰å…¨** (`presentationActions.ts` çš„ç±»å‹æ–­è¨€)
4. **PPTX å¯¼å‡ºä¸€è‡´æ€§** (`exportToPPT.ts` çš„ OpenXML ç”Ÿæˆ)
5. **çŠ¶æ€åŒæ­¥å¤æ‚æ€§** (Zustand + ç»„ä»¶çŠ¶æ€)
